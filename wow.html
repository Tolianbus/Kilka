<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>FORMULA</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: black;
      overflow: hidden;
    }
    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      right: 10px;
      background: #111;
      padding: 15px;
      border-radius: 10px;
      font-family: monospace;
      color: white;
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }
    input, button {
      padding: 5px 10px;
      background: #222;
      color: #0f0;
      border: none;
      font-family: monospace;
      font-size: 14px;
      border-radius: 4px;
      cursor: pointer;
    }
    #formula {
      flex: 1 1 100%;
      font-size: 16px;
      background: #000;
      color: #0f0;
      padding: 8px;
      border: 1px solid #444;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<div id="ui">
  <input id="formula" value="Math.sin(t)*50" />
  <button onclick="setFormula('Math.sin(t)*50')">–°–∏–Ω—É—Å</button>
  <button onclick="setFormula('-0.05*t*t + 5*t')">–ü–∞—Ä–∞–±–æ–ª–∞</button>
  <button onclick="setFormula('Math.log(t+1)*30')">–õ–æ–≥–∞—Ä–∏—Ñ–º</button>
  <button onclick="setFormula('t*2')">–õ–∏–Ω–∏—è</button>
  <button onclick="setFormula('Math.tan(t*0.1)*5')">–¢–∞–Ω–≥–µ–Ω—Å</button>
  <button onclick="setFormula('Math.sin(t*0.3)*Math.exp(-t*0.01)*100')">–ó–∞—Ç—É—Ö–∞—é—â–∞—è</button>
  <button onclick="setFormula('Math.abs(Math.sin(t*0.2))*100')">|–°–∏–Ω—É—Å|</button>
  <button onclick="setFormula('Math.cos(t*0.1)*t*0.5')">–°–ø–∏—Ä–∞–ª—å</button>
  <button onclick="setFormula('Math.sqrt(t)*10')">–ö–æ—Ä–µ–Ω—å</button>
  <button onclick="setFormula('Math.sin(t*0.2)*Math.cos(t*0.05)*80')">–ì–∞—Ä–º–æ–Ω–∏–∫–∞</button>
  <button onclick="setFormula('Math.exp(Math.sin(t*0.1))*10')">–≠–∫—Å–ø. —Å–∏–Ω—É—Å</button>
  <button onclick="setFormula('50*Math.sin(t*0.05)+30*Math.sin(t*0.2)')">–°—É–ø–µ—Ä–ø–æ–∑–∏—Ü–∏—è</button>
  <button onclick="setFormula('Math.pow(Math.sin(t*0.2),3)*100')">–°–∏–Ω—É—Å¬≥</button>
  <button onclick="setFormula('Math.sin(t*0.2+t*0.005)*t*0.2')">–†–∞—Å—à–∏—Ä—è—é—â–∞—è—Å—è</button>
  <button onclick="setFormula('Math.sin(t*0.2)*Math.sin(t*0.03)*100')">–ò–Ω—Ç–µ—Ä—Ñ–µ—Ä–µ–Ω—Ü–∏—è</button>
  <button onclick="setFormula('Math.cos(t*0.05)*Math.sin(t*0.1)*100')">XY –í–æ–ª–Ω–∞</button>
  <button onclick="setFormula('Math.sin(t*0.1)*t*0.5')">–†–∞—Å—Ç—É—â–∏–π —Å–∏–Ω—É—Å</button>
  <button onclick="setFormula('Math.atan(Math.sin(t*0.1)*10)*100')">–ê—Ä–∫—Ç–∞–Ω –≤–æ–ª–Ω–∞</button>
  <button onclick="setFormula('Math.sin(t*0.1)*Math.log(t+1)*20')">–õ–æ–≥-—Å–∏–Ω—É—Å</button>
  <button onclick="setFormula('Math.sin(t*0.05)*Math.cos(t*0.2)*t*0.3')">–°–ø–∏—Ä–∞–ª—å 2D</button>
  <button onclick="setFormula('Math.sin(t)*Math.cos(t*0.1)*t*0.3')">–°–ª–æ–∂–Ω–∞—è —Ä—è–±—å</button>
  <button onclick="setFormula('Math.sin(3*t)*Math.cos(2*t)*50')">–õ–∏—Å—Å–∞–∂—É</button>
  <button onclick="setFormula('Math.pow(Math.sin(t*0.2)*Math.cos(t*0.05),3)*120')">–ü—ã–ª–∞—é—â–∞—è —Ä–æ–∑–∞</button>
  <button onclick="setFormula('Math.sin(t)*Math.cos(t)*Math.sin(t*0.1)*100')">–ü—É–ª—å—Å–∞—Ü–∏—è</button>
  <button onclick="setFormula('Math.sin(t)*t*0.1*Math.cos(t*0.05)')">–ì–∞–ª–∞–∫—Ç–∏–∫–∞</button>
  <button onclick="randomFormula()">üé≤ –°–ª—É—á–∞–π–Ω–∞—è</button>
</div>
<canvas id="c"></canvas>
<script>
let canvas = document.getElementById("c"),
    ctx = canvas.getContext("2d"),
    W = canvas.width = innerWidth,
    H = canvas.height = innerHeight,
    formulaInput = document.getElementById("formula"),
    bullets = [],
    colors = ["#f00","#0f0","#0ff","#ff0","#f0f"];

const formulas = [
  "Math.sin(t)*50",
  "-0.05*t*t + 5*t",
  "Math.log(t+1)*30",
  "t*2",
  "Math.tan(t*0.1)*5",
  "Math.sin(t*0.3)*Math.exp(-t*0.01)*100",
  "Math.abs(Math.sin(t*0.2))*100",
  "Math.cos(t*0.1)*t*0.5",
  "Math.sqrt(t)*10",
  "Math.sin(t*0.2)*Math.cos(t*0.05)*80",
  "Math.exp(Math.sin(t*0.1))*10",
  "50*Math.sin(t*0.05)+30*Math.sin(t*0.2)",
  "Math.pow(Math.sin(t*0.2),3)*100",
  "Math.sin(t*0.2+t*0.005)*t*0.2",
  "Math.sin(t*0.2)*Math.sin(t*0.03)*100",
  "Math.cos(t*0.05)*Math.sin(t*0.1)*100",
  "Math.sin(t*0.1)*t*0.5",
  "Math.atan(Math.sin(t*0.1)*10)*100",
  "Math.sin(t*0.1)*Math.log(t+1)*20",
  "Math.sin(t*0.05)*Math.cos(t*0.2)*t*0.3",
  "Math.sin(t)*Math.cos(t*0.1)*t*0.3",
  "Math.sin(3*t)*Math.cos(2*t)*50",
  "Math.pow(Math.sin(t*0.2)*Math.cos(t*0.05),3)*120",
  "Math.sin(t)*Math.cos(t)*Math.sin(t*0.1)*100",
  "Math.sin(t)*t*0.1*Math.cos(t*0.05)"
];

function setFormula(f) {
  formulaInput.value = f;
}

function randomFormula() {
  const f = formulas[Math.floor(Math.random() * formulas.length)];
  setFormula(f);
}

canvas.addEventListener("click", e => {
  let fstr = formulaInput.value;
  try {
    let f = new Function("t", "return " + fstr);
    bullets.push({
      x0: e.offsetX,
      y0: e.offsetY,
      t: 0,
      trail: [],
      f: f,
      c: colors[Math.floor(Math.random() * colors.length)]
    });
  } catch {}
});

function loop() {
  ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
  ctx.fillRect(0, 0, W, H);

  for (let b of bullets) {
    let steps = 3;
    for (let s = 0; s < steps; s++) {
      b.t += 1 / steps;
      let vx = 4;
      let x = b.x0 + b.t * vx;
      let y;
      try { y = b.y0 - b.f(b.t); } catch { y = b.y0; }
      b.trail.push({x, y, a: 1});
    }

    ctx.strokeStyle = b.c;
    ctx.beginPath();
    for (let i = 0; i < b.trail.length - 1; i++) {
      let p1 = b.trail[i], p2 = b.trail[i + 1];
      ctx.globalAlpha = p1.a;
      ctx.moveTo(p1.x, p1.y);
      ctx.lineTo(p2.x, p2.y);
    }
    ctx.stroke();
    ctx.globalAlpha = 1;

    let last = b.trail[b.trail.length - 1];
    ctx.fillStyle = b.c;
    ctx.beginPath();
    ctx.arc(last.x, last.y, 4, 0, 2 * Math.PI);
    ctx.fill();

    for (let p of b.trail) p.a -= 0.01;
    b.trail = b.trail.filter(p => p.a > 0);
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
